# 简介

## 介绍

[tb](https://github.com/TarsCloud/TarsBenchmark)是专门为tars服务量身订做的无码压测工具，利用事件驱动和多进程，充分利用压测机器计算资源和网络资源，具备以下特性：

 - 网络高性能：8核机器TPS支持超过20W/S;
 - 通讯扩展性：网络层支持TCP/UDP两种协议方式;
 - 协议扩展性：应用层支持Http,Tars服务压测，提供协议开放能力;
 - 完善的实时统计与监控支持。提供周期内的请求数/TPS/耗时/成功率分布;

## 框架结构

tb工具采用多进程方式设计，主进程负责资源调度和外显，压测进程负责数据收发和统计，支持TCP/UDP，采用协议代理工厂模式管理各类service协议，默认支持http/tars协议的压测，支持自动发现，主进程和压测进程之间通过控制信息通过信号方式交互，数据通过无锁共享内存队列交互，以达到最低的资源消耗，主进程会周期地搜集各压测进程的收发统计信息经过简单汇总之后打印到控制台。

[tb系统结构](../assets/tb-platform.png)


## 使用说明

简单示意
```text
./tb -c 600 -s 6000 -D 192.168.31.1 -P 10505 -p tars -S tars.DemoServer.DemoObj -M test -C test.txt
```
参数说明
```
  -h                   帮助信息
  -c                   连接数量
  -D                   压测服务器IP，多个IP用';'区隔
  -P                   网络传输端口
  -p                   接口通信协议(tars|http)
  -t(可选)             单个请求超时时间，默认3秒
  -T(可选)             网络层协议，默认tcp
  -I(可选)             压测持续时间，单位为秒
  -s(可选)             最大速率限制，为空或0表示不限速
  -i(可选)             控制台打印周期时间，单位为秒
  -n(可选)             最大压测进程限制，默认跟CPU核心数

tars协议参数
  -S                   tars服务servant名称
  -M                   tars服务接口方法
  -C                   压测用例文件，详见<Tars用例文件生成>和<Tars用例编写说明>

http协议参数
  -H(可选)             :设置Header内容，建议用""修饰
  -C(可选)             :设置Cookie内容，建议用""修饰
  -F(可选)             :POST请求内容文件
  -u                   :目标URL地址

```

详细说明参考[tb工具使用说明](../dev/tarsbenchmark/README.md)

